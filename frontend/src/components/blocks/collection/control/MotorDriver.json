{"editor":{"id":"bb24521a-8c41-4f55-8e96-b7aff41c4297","offsetX":-3,"offsetY":-4,"zoom":100,"gridSize":0,"layers":[{"id":"50937002-f39a-4d49-a9eb-39771635497f","type":"diagram-links","isSvg":true,"transformed":true,"models":{"4ed5d5b1-1755-4ed2-bbcc-9655d720b7a7":{"id":"4ed5d5b1-1755-4ed2-bbcc-9655d720b7a7","type":"default","selected":false,"source":"0001-14f63bb0-570c-4d46-aad3-e9f1f1e687ff","sourcePort":"c1a3f539-be26-40d0-aa0b-831a2e6f882d","target":"8a7a9a8d-260f-4d31-a515-f202e4f9e005","targetPort":"eb5daa6d-325f-4b4b-827b-daa13f6e7ba9","points":[{"id":"4d8f275f-7ec8-496c-ab93-95e0a6578cda","type":"point","x":547,"y":143.6999969482422},{"id":"2ba7db04-6ccb-403e-bac1-522c1bb9b16f","type":"point","x":540.1875,"y":216.5}],"labels":[],"width":3,"color":"gray","curvyness":50,"selectedColor":"rgb(0,192,255)"},"68a44ab0-3e9e-447c-a9a2-717ffb6be1dd":{"id":"68a44ab0-3e9e-447c-a9a2-717ffb6be1dd","type":"default","selected":false,"source":"0002-cb4c125e-14b6-4322-b252-35d2817b2832","sourcePort":"c76ea7fc-9390-4252-bcaa-01bd0afe7bfd","target":"8a7a9a8d-260f-4d31-a515-f202e4f9e005","targetPort":"e40c64c5-80f5-4cab-8203-a4b3431b49ae","points":[{"id":"fd70d57e-ad9b-4827-a179-26e599b59821","type":"point","x":827,"y":141.6999969482422},{"id":"2f355eab-dbab-4125-a6e6-3c11b62b0613","type":"point","x":817.0875244140625,"y":216.5}],"labels":[],"width":3,"color":"gray","curvyness":50,"selectedColor":"rgb(0,192,255)"},"960a8bf3-13a4-4773-a8bb-4ed4cae3a430":{"id":"960a8bf3-13a4-4773-a8bb-4ed4cae3a430","type":"default","selected":false,"source":"e14a28e9-0990-4730-9f11-1f52075edbd3","sourcePort":"4c189456-98bc-4610-be97-d8cc759247b2","target":"8a7a9a8d-260f-4d31-a515-f202e4f9e005","targetPort":"4fd65cef-d69c-4534-8d18-3043151b46d8","points":[{"id":"834e9b97-e99f-47aa-b918-9fbb355cf685","type":"point","x":192.5,"y":341.6000061035156},{"id":"f0d2c509-53d2-4b08-8070-853f41395bbc","type":"point","x":292.5,"y":355.82501220703125}],"labels":[],"width":3,"color":"gray","curvyness":50,"selectedColor":"rgb(0,192,255)"},"3fc6ee51-2c87-4c63-a032-0096970be90c":{"id":"3fc6ee51-2c87-4c63-a032-0096970be90c","type":"default","selected":false,"source":"8cc17ddf-ab60-4e34-ac22-9e3ce82e69a2","sourcePort":"8e68120d-9212-4c81-b37b-a6419b315258","target":"8a7a9a8d-260f-4d31-a515-f202e4f9e005","targetPort":"b53a21e7-aba0-43a9-b5b1-e7feca9d5831","points":[{"id":"8dbad1bd-6bdf-4a37-8df1-d6934dece038","type":"point","x":200.5,"y":495.60003662109375},{"id":"f49750b2-f0ea-43b7-bde8-571909ef8105","type":"point","x":292.5,"y":495.1500244140625}],"labels":[],"width":3,"color":"gray","curvyness":50,"selectedColor":"rgb(0,192,255)"}}},{"id":"220b70ae-199a-4bc2-8a5d-05e7ec6ae5ca","type":"diagram-nodes","isSvg":false,"transformed":true,"models":{"0001-14f63bb0-570c-4d46-aad3-e9f1f1e687ff":{"id":"0001-14f63bb0-570c-4d46-aad3-e9f1f1e687ff","type":"basic.constant","selected":false,"x":486,"y":28,"ports":[{"id":"c1a3f539-be26-40d0-aa0b-831a2e6f882d","type":"port.output","x":539.5,"y":136.1999969482422,"name":"constant-out","alignment":"bottom","parentNode":"0001-14f63bb0-570c-4d46-aad3-e9f1f1e687ff","links":["4ed5d5b1-1755-4ed2-bbcc-9655d720b7a7"],"in":false,"label":"constant-out","hideLabel":true}],"data":{"name":"Frequency","value":"30.0","local":true}},"0002-cb4c125e-14b6-4322-b252-35d2817b2832":{"id":"0002-cb4c125e-14b6-4322-b252-35d2817b2832","type":"basic.constant","selected":false,"x":766,"y":26,"ports":[{"id":"c76ea7fc-9390-4252-bcaa-01bd0afe7bfd","type":"port.output","x":819.5,"y":134.1999969482422,"name":"constant-out","alignment":"bottom","parentNode":"0002-cb4c125e-14b6-4322-b252-35d2817b2832","links":["68a44ab0-3e9e-447c-a9a2-717ffb6be1dd"],"in":false,"label":"constant-out","hideLabel":true}],"data":{"name":"ROS Topic","value":"/robot/cmd_vel","local":true}},"8a7a9a8d-260f-4d31-a515-f202e4f9e005":{"id":"8a7a9a8d-260f-4d31-a515-f202e4f9e005","type":"basic.code","selected":false,"x":284,"y":208,"ports":[{"id":"4fd65cef-d69c-4534-8d18-3043151b46d8","type":"port.input","x":285,"y":348.32501220703125,"name":"Inp","alignment":"left","parentNode":"8a7a9a8d-260f-4d31-a515-f202e4f9e005","links":["960a8bf3-13a4-4773-a8bb-4ed4cae3a430"],"in":true,"label":"Inp","hideLabel":false},{"id":"b53a21e7-aba0-43a9-b5b1-e7feca9d5831","type":"port.input","x":285,"y":487.6500244140625,"name":"E","alignment":"left","parentNode":"8a7a9a8d-260f-4d31-a515-f202e4f9e005","links":["3fc6ee51-2c87-4c63-a032-0096970be90c"],"in":true,"label":"E","hideLabel":false},{"id":"eb5daa6d-325f-4b4b-827b-daa13f6e7ba9","type":"port.parameter","x":532.6875,"y":209,"name":"Frequency","alignment":"top","parentNode":"8a7a9a8d-260f-4d31-a515-f202e4f9e005","links":["4ed5d5b1-1755-4ed2-bbcc-9655d720b7a7"],"in":true,"label":"Frequency","hideLabel":false},{"id":"e40c64c5-80f5-4cab-8203-a4b3431b49ae","type":"port.parameter","x":809.5875244140625,"y":209,"name":"ROSTopic","alignment":"top","parentNode":"8a7a9a8d-260f-4d31-a515-f202e4f9e005","links":["68a44ab0-3e9e-447c-a9a2-717ffb6be1dd"],"in":true,"label":"ROSTopic","hideLabel":false}],"data":{"code":"#!/usr/bin/env python3\n\nimport rospy\nimport numpy as np\nfrom time import sleep\nfrom geometry_msgs.msg import Twist\nfrom utils.wires.wire_str import read_string\nfrom utils.tools.freq_monitor import monitor_frequency\n\nlinear_velocity, angular_velocity = 0.0, 0.0\n\ndef callback(mem):\n    \n    global linear_velocity, angular_velocity\n    \n    msg = mem.get()\n    if msg is not None:\n        linear_velocity = float(msg[0])\n        angular_velocity = float(msg[1])\n\ndef loop(block_name, input_wires, output_wires, parameters, flags):\n\n    input_0 = read_image(input_wires[1])\n\n    rospy.init_node(\"motordriverVC\", anonymous=True)\n    output_0 = rospy.Publisher(parameters[1], Twist, queue_size=10)\n\n    enabled = False\n    try:\n        enable_wire = read_string(input_wires[0])\n    except IndexError:\n        enabled = True\n\n    required_frequency, update = float(parameters[0]), 1\n    control_data = np.array([0.0,0.03])\n\n    if flags[0] == 1:\n        monitor_frequency(block_name, control_data, required_frequency, update)\n\n    data = Twist()\n\n    try:\n    \n        while not rospy.is_shutdown():\n        \n            if enabled or (update := bool(enable_wire.get()[0])):\n        \n                callback(input_0)\n                data.linear.x = linear_velocity\n                data.angular.z = angular_velocity\n                output_0.publish(data)\n                control_data[0] += 1\n                \n            sleep(control_data[1])\n\n    except KeyboardInterrupt:\n    \n        input_0.release()\n        enable_wire.release()\n","params":[{"name":"Frequency"},{"name":"ROSTopic"}],"ports":{"in":[{"name":"Inp"},{"name":"E"}],"out":[]},"size":{"width":"745px","height":"375px"}}},"e14a28e9-0990-4730-9f11-1f52075edbd3":{"id":"e14a28e9-0990-4730-9f11-1f52075edbd3","type":"basic.input","selected":false,"x":99,"y":315,"ports":[{"id":"4c189456-98bc-4610-be97-d8cc759247b2","type":"port.output","x":185,"y":334.1000061035156,"name":"input-out","alignment":"right","parentNode":"e14a28e9-0990-4730-9f11-1f52075edbd3","links":["960a8bf3-13a4-4773-a8bb-4ed4cae3a430"],"in":false,"label":"input-out","hideLabel":true}],"data":{"name":"Inp"}},"8cc17ddf-ab60-4e34-ac22-9e3ce82e69a2":{"id":"8cc17ddf-ab60-4e34-ac22-9e3ce82e69a2","type":"basic.input","selected":false,"x":107,"y":469,"ports":[{"id":"8e68120d-9212-4c81-b37b-a6419b315258","type":"port.output","x":193,"y":488.10003662109375,"name":"input-out","alignment":"right","parentNode":"8cc17ddf-ab60-4e34-ac22-9e3ce82e69a2","links":["3fc6ee51-2c87-4c63-a032-0096970be90c"],"in":false,"label":"input-out","hideLabel":true}],"data":{"name":"E"}}}}]},"version":"3.0","package":{"name":"MotorDriver","version":"1.0.0","description":"Controls Robot's Movement.","author":"Muhammad Taha Suhail","image":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIj8+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB2aWV3Qm94PSIwIDAgMTI4IDEyOCIgd2lkdGg9IjUxMiIgaGVpZ2h0PSI1MTIiPjx0aXRsZT5NT1RPUiBEQzwvdGl0bGU+PHBhdGggZD0iTTU0LjQ2OSwzNC42MjVINzQuNjNhNy4yOTQsNy4yOTQsMCwwLDEsNy4yOTQsNy4yOTRWNTJhMCwwLDAsMCwxLDAsMEg0Ny4xNzVhMCwwLDAsMCwxLDAsMFY0MS45MTlBNy4yOTQsNy4yOTQsMCwwLDEsNTQuNDY5LDM0LjYyNVoiIHN0eWxlPSJmaWxsOiNiYWRkZmEiLz48cGF0aCBkPSJNODAuNDI1LDUySDQ4LjY3NVY3Mi4xOTFBNC4wNzYsNC4wNzYsMCwwLDAsNTEuMyw3NmgwYTQuMDc2LDQuMDc2LDAsMCwxLDIuNjI1LDMuODA5VjgwLjVoMjEuMjV2LS42OTFBNC4wNzYsNC4wNzYsMCwwLDEsNzcuOCw3NmgwYTQuMDc2LDQuMDc2LDAsMCwwLDIuNjI1LTMuODA5WiIgc3R5bGU9ImZpbGw6I2ZmZiIvPjxyZWN0IHg9IjYxLjExMiIgeT0iODYuNSIgd2lkdGg9IjYuODc1IiBoZWlnaHQ9IjYuODc1IiBzdHlsZT0iZmlsbDojYmFkZGZhIi8+PHBhdGggZD0iTTc0LjYzLDMzLjUyNUg1NC40NjlhOC40LDguNCwwLDAsMC04LjM5NCw4LjM5NVY1MmExLjEsMS4xLDAsMCwwLDEuMSwxLjFoLjRWNzIuMTkxYTUuMjA2LDUuMjA2LDAsMCwwLDMuMzMzLDQuODM3LDIuOTkxLDIuOTkxLDAsMCwxLDEuOTE2LDIuNzhWODAuNWExLjEsMS4xLDAsMCwwLDEuMSwxLjFINjMuNDV2My44SDYxLjExMmExLjEsMS4xLDAsMCwwLTEuMSwxLjF2Ni44NzVhMS4xLDEuMSwwLDAsMCwxLjEsMS4xaDYuODc1YTEuMSwxLjEsMCwwLDAsMS4xLTEuMVY4Ni41YTEuMSwxLjEsMCwwLDAtMS4xLTEuMUg2NS42NVY4MS42aDkuNTI1YTEuMSwxLjEsMCwwLDAsMS4xLTEuMXYtLjY5MWEyLjk5MSwyLjk5MSwwLDAsMSwxLjkxNi0yLjc4LDUuMjA2LDUuMjA2LDAsMCwwLDMuMzMzLTQuODM3VjUzLjFoLjRhMS4xLDEuMSwwLDAsMCwxLjEtMS4xVjQxLjkyQTguNCw4LjQsMCwwLDAsNzQuNjMsMzMuNTI1Wm0tNy43NDMsNTguNzVINjIuMjEyVjg3LjZoNC42NzVaTTQ4LjI3NSw0MS45MmE2LjIsNi4yLDAsMCwxLDYuMTk0LTYuMkg3NC42M2E2LjIsNi4yLDAsMCwxLDYuMTk0LDYuMlY1MC45SDQ4LjI3NVptMzEuMDUsMzAuMjcyYTIuOTkxLDIuOTkxLDAsMCwxLTEuOTE2LDIuNzhBNS4yMSw1LjIxLDAsMCwwLDc0LjA5MSw3OS40SDU1LjAwOGE1LjIxLDUuMjEsMCwwLDAtMy4zMTctNC40MjksMi45OTEsMi45OTEsMCwwLDEtMS45MTYtMi43OFY1My4xaDI5LjU1WiIgc3R5bGU9ImZpbGw6IzM5NDlhYSIvPjxwYXRoIGQ9Ik01Ny44LDcxLjZhMS4xLDEuMSwwLDAsMCwxLjEtMS4xVjU4Ljc1YTEuMSwxLjEsMCwwLDAtMi4yLDBWNzAuNUExLjEsMS4xLDAsMCwwLDU3LjgsNzEuNloiIHN0eWxlPSJmaWxsOiMzOTQ5YWEiLz48cGF0aCBkPSJNNjQuNTUsNzEuNmExLjEsMS4xLDAsMCwwLDEuMS0xLjFWNTguNzVhMS4xLDEuMSwwLDAsMC0yLjIsMFY3MC41QTEuMSwxLjEsMCwwLDAsNjQuNTUsNzEuNloiIHN0eWxlPSJmaWxsOiMzOTQ5YWEiLz48cGF0aCBkPSJNNzEuMyw3MS42YTEuMSwxLjEsMCwwLDAsMS4xLTEuMVY1OC43NWExLjEsMS4xLDAsMCwwLTIuMiwwVjcwLjVBMS4xLDEuMSwwLDAsMCw3MS4zLDcxLjZaIiBzdHlsZT0iZmlsbDojMzk0OWFhIi8+PC9zdmc+Cg=="},"design":{"board":"Python3-Noetic","graph":{"blocks":[{"id":"0001-14f63bb0-570c-4d46-aad3-e9f1f1e687ff","type":"basic.constant","data":{"name":"Frequency","value":"30.0","local":true},"position":{"x":486,"y":28}},{"id":"0002-cb4c125e-14b6-4322-b252-35d2817b2832","type":"basic.constant","data":{"name":"ROS Topic","value":"/robot/cmd_vel","local":true},"position":{"x":766,"y":26}},{"id":"8a7a9a8d-260f-4d31-a515-f202e4f9e005","type":"basic.code","data":{"code":"#!/usr/bin/env python3\n\nimport rospy\nimport numpy as np\nfrom time import sleep\nfrom geometry_msgs.msg import Twist\nfrom utils.wires.wire_str import read_string\nfrom utils.tools.freq_monitor import monitor_frequency\n\nlinear_velocity, angular_velocity = 0.0, 0.0\n\ndef callback(mem):\n    \n    global linear_velocity, angular_velocity\n    \n    msg = mem.get()\n    if msg is not None:\n        linear_velocity = float(msg[0])\n        angular_velocity = float(msg[1])\n\ndef loop(block_name, input_wires, output_wires, parameters, flags):\n\n    input_0 = read_image(input_wires[1])\n\n    rospy.init_node(\"motordriverVC\", anonymous=True)\n    output_0 = rospy.Publisher(parameters[1], Twist, queue_size=10)\n\n    enabled = False\n    try:\n        enable_wire = read_string(input_wires[0])\n    except IndexError:\n        enabled = True\n\n    required_frequency, update = float(parameters[0]), 1\n    control_data = np.array([0.0,0.03])\n\n    if flags[0] == 1:\n        monitor_frequency(block_name, control_data, required_frequency, update)\n\n    data = Twist()\n\n    try:\n    \n        while not rospy.is_shutdown():\n        \n            if enabled or (update := bool(enable_wire.get()[0])):\n        \n                callback(input_0)\n                data.linear.x = linear_velocity\n                data.angular.z = angular_velocity\n                output_0.publish(data)\n                control_data[0] += 1\n                \n            sleep(control_data[1])\n\n    except KeyboardInterrupt:\n    \n        input_0.release()\n        enable_wire.release()\n","params":[{"name":"Frequency"},{"name":"ROSTopic"}],"ports":{"in":[{"name":"Inp"},{"name":"E"}],"out":[]},"size":{"width":"745px","height":"375px"}},"position":{"x":284,"y":208}},{"id":"e14a28e9-0990-4730-9f11-1f52075edbd3","type":"basic.input","data":{"name":"Inp"},"position":{"x":99,"y":315}},{"id":"8cc17ddf-ab60-4e34-ac22-9e3ce82e69a2","type":"basic.input","data":{"name":"E"},"position":{"x":107,"y":469}}],"wires":[{"source":{"block":"0001-14f63bb0-570c-4d46-aad3-e9f1f1e687ff","port":"constant-out"},"target":{"block":"8a7a9a8d-260f-4d31-a515-f202e4f9e005","port":"Frequency"}},{"source":{"block":"0002-cb4c125e-14b6-4322-b252-35d2817b2832","port":"constant-out"},"target":{"block":"8a7a9a8d-260f-4d31-a515-f202e4f9e005","port":"ROSTopic"}},{"source":{"block":"e14a28e9-0990-4730-9f11-1f52075edbd3","port":"input-out"},"target":{"block":"8a7a9a8d-260f-4d31-a515-f202e4f9e005","port":"Inp"}},{"source":{"block":"8cc17ddf-ab60-4e34-ac22-9e3ce82e69a2","port":"input-out"},"target":{"block":"8a7a9a8d-260f-4d31-a515-f202e4f9e005","port":"E"}}]}},"dependencies":{}}