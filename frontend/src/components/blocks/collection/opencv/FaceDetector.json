{"editor":{"id":"e9ccbfa0-5dc6-435e-93cf-c3944601dcad","offsetX":0,"offsetY":3,"zoom":100,"gridSize":0,"layers":[{"id":"38cd8d0f-ac0b-45ef-8f5b-b3c1374f0d54","type":"diagram-links","isSvg":true,"transformed":true,"models":{"daee49c7-9610-475c-8760-a4c4820643a1":{"id":"daee49c7-9610-475c-8760-a4c4820643a1","type":"default","selected":false,"source":"0001-63745519-5dec-4f70-9e52-dbeacf4d8dea","sourcePort":"13313ee2-fc83-413f-a548-3a2ee045d0a6","target":"a0403155-b994-46ed-b65e-80646aece826","targetPort":"3791028a-0f07-4648-903b-2b03a44836f3","points":[{"id":"a47ed8e1-c569-43b7-aeea-74e7c395c553","type":"point","x":604,"y":128.6999969482422},{"id":"0ec98c72-a48e-4f7b-b1be-2a563b533e8b","type":"point","x":530.5875244140625,"y":209.5}],"labels":[],"width":3,"color":"gray","curvyness":50,"selectedColor":"rgb(0,192,255)"},"324e0038-eb2b-4ce0-abf5-7e1c60a01a52":{"id":"324e0038-eb2b-4ce0-abf5-7e1c60a01a52","type":"default","selected":false,"source":"0002-eff9b053-aae5-4081-a9bf-3dad18a381e8","sourcePort":"0a80a015-5bfc-488a-90e2-c98b8c11eb7e","target":"a0403155-b994-46ed-b65e-80646aece826","targetPort":"eb72a8b1-cae9-4833-821f-9b973ed2575e","points":[{"id":"6b8b68ac-ac7b-4b0e-8bd5-a1c9d49b273e","type":"point","x":760,"y":128.6999969482422},{"id":"50da8b39-648a-4195-b6ef-b011bc9b79b7","type":"point","selected":true,"x":828.6124877929688,"y":209.5}],"labels":[],"width":3,"color":"gray","curvyness":50,"selectedColor":"rgb(0,192,255)"},"b62cf259-caac-4e28-b915-43357172dc07":{"id":"b62cf259-caac-4e28-b915-43357172dc07","type":"default","selected":false,"source":"80874c07-fa76-46f8-a32c-738527dd34ff","sourcePort":"40c5414f-029c-45d1-a871-4d931682e961","target":"a0403155-b994-46ed-b65e-80646aece826","targetPort":"5460fec3-d363-4d00-9052-a4a7ec64169f","points":[{"id":"7e27a2b7-ede2-4f9f-816f-99e9c98cb916","type":"point","x":183.5,"y":310.6000061035156},{"id":"2c60499e-9e83-40ab-a701-b5451494e9e5","type":"point","x":267.5,"y":325.1625061035156}],"labels":[],"width":3,"color":"gray","curvyness":50,"selectedColor":"rgb(0,192,255)"},"4bdad402-642e-4b25-b0bc-a39d3c138056":{"id":"4bdad402-642e-4b25-b0bc-a39d3c138056","type":"default","selected":false,"source":"25770c54-f7e2-44f4-9bda-9cbf42401cdf","sourcePort":"9f3ee216-2cbe-462b-a325-df75a5c07210","target":"a0403155-b994-46ed-b65e-80646aece826","targetPort":"ade9edbd-fdd0-4032-952d-f4c353df0128","points":[{"id":"88656e7f-873c-4032-a853-8e186cb573fd","type":"point","x":192.5,"y":450.6000061035156},{"id":"6691efc7-d141-4ca2-9d4b-dc139f596fb3","type":"point","x":267.5,"y":440.82501220703125}],"labels":[],"width":3,"color":"gray","curvyness":50,"selectedColor":"rgb(0,192,255)"},"fc2f7bd9-5fbf-4c09-932c-04b5d52b3d5f":{"id":"fc2f7bd9-5fbf-4c09-932c-04b5d52b3d5f","type":"default","selected":false,"source":"a0403155-b994-46ed-b65e-80646aece826","sourcePort":"20360a9d-a2e9-49c3-bb27-260332b07b0c","target":"421c872f-c3b0-4de0-99dd-1d626d19c9c3","targetPort":"d9556269-14d7-4002-9ff1-0c47a64f9996","points":[{"id":"615ede27-856d-4a9b-918d-6e9fde3cc7e7","type":"point","x":1096.1624755859375,"y":383},{"id":"613d1c70-a847-4335-ade1-e5331f5844f4","type":"point","x":1215.5,"y":380.6000061035156}],"labels":[],"width":3,"color":"gray","curvyness":50,"selectedColor":"rgb(0,192,255)"}}},{"id":"84eccf1a-587c-4feb-b913-4a31a2ff6686","type":"diagram-nodes","isSvg":false,"transformed":true,"models":{"0001-63745519-5dec-4f70-9e52-dbeacf4d8dea":{"id":"0001-63745519-5dec-4f70-9e52-dbeacf4d8dea","type":"basic.constant","selected":false,"x":543,"y":13,"ports":[{"id":"13313ee2-fc83-413f-a548-3a2ee045d0a6","type":"port.output","x":596.5,"y":121.19999694824219,"name":"constant-out","alignment":"bottom","parentNode":"0001-63745519-5dec-4f70-9e52-dbeacf4d8dea","links":["daee49c7-9610-475c-8760-a4c4820643a1"],"in":false,"label":"constant-out","hideLabel":true}],"data":{"name":"Frequency","value":"30.0","local":true}},"0002-eff9b053-aae5-4081-a9bf-3dad18a381e8":{"id":"0002-eff9b053-aae5-4081-a9bf-3dad18a381e8","type":"basic.constant","selected":false,"x":699,"y":13,"ports":[{"id":"0a80a015-5bfc-488a-90e2-c98b8c11eb7e","type":"port.output","x":752.5,"y":121.19999694824219,"name":"constant-out","alignment":"bottom","parentNode":"0002-eff9b053-aae5-4081-a9bf-3dad18a381e8","links":["324e0038-eb2b-4ce0-abf5-7e1c60a01a52"],"in":false,"label":"constant-out","hideLabel":true}],"data":{"name":"box/image","value":"image","local":true}},"a0403155-b994-46ed-b65e-80646aece826":{"id":"a0403155-b994-46ed-b65e-80646aece826","type":"basic.code","selected":false,"x":259,"y":201,"ports":[{"id":"5460fec3-d363-4d00-9052-a4a7ec64169f","type":"port.input","x":260,"y":317.6625061035156,"name":"Inp","alignment":"left","parentNode":"a0403155-b994-46ed-b65e-80646aece826","links":["b62cf259-caac-4e28-b915-43357172dc07"],"in":true,"label":"Inp","hideLabel":false},{"id":"ade9edbd-fdd0-4032-952d-f4c353df0128","type":"port.input","x":260,"y":433.32501220703125,"name":"E","alignment":"left","parentNode":"a0403155-b994-46ed-b65e-80646aece826","links":["4bdad402-642e-4b25-b0bc-a39d3c138056"],"in":true,"label":"E","hideLabel":false},{"id":"20360a9d-a2e9-49c3-bb27-260332b07b0c","type":"port.output","x":1088.6624755859375,"y":375.5,"name":"Out","alignment":"right","parentNode":"a0403155-b994-46ed-b65e-80646aece826","links":["fc2f7bd9-5fbf-4c09-932c-04b5d52b3d5f"],"in":false,"label":"Out","hideLabel":false},{"id":"3791028a-0f07-4648-903b-2b03a44836f3","type":"port.parameter","x":523.0875244140625,"y":202,"name":"Frequency","alignment":"top","parentNode":"a0403155-b994-46ed-b65e-80646aece826","links":["daee49c7-9610-475c-8760-a4c4820643a1"],"in":true,"label":"Frequency","hideLabel":false},{"id":"eb72a8b1-cae9-4833-821f-9b973ed2575e","type":"port.parameter","x":821.1124877929688,"y":202,"name":"BoxOrImage","alignment":"top","parentNode":"a0403155-b994-46ed-b65e-80646aece826","links":["324e0038-eb2b-4ce0-abf5-7e1c60a01a52"],"in":true,"label":"BoxOrImage","hideLabel":false}],"data":{"code":"import cv2 as cv\nimport numpy as np\nfrom time import sleep\nfrom utils.wires.wire_img import read_image, share_image\nfrom utils.wires.wire_str import read_string, share_string\nfrom utils.tools.freq_monitor import monitor_frequency\n\ndef loop(block_name, input_wires, output_wires, parameters, flags):\n\n    input_0 = read_image(input_wires[0])\n    output_0 = share_image(output_wires[0])\n    choice = parameters[1]\n\n    enabled = False\n    try:\n        enable_wire = read_string(input_wires[1])\n    except IndexError:\n        enabled = True\n    \n    required_frequency, update = float(parameters[0]), 1\n    control_data = np.array([0.0,0.03])\n    \n    if flags[0] == 1:\n        monitor_frequency(block_name, control_data, required_frequency, update)\n\n    classifier = cv.CascadeClassifier('utils/models/haar_cascade/haarcascade_frontalface_default.xml')\n\n    try:\n    \n        if choice == 'image':\n\n            output_0 = share_image(output_wires[0])\n        \n            while True:\n        \n                if enabled or (update := bool(enable_wire.get()[0])):\n    \n                    img = input_0.get()\n                    if img is not None:\n                        bboxes = classifier.detectMultiScale(img)\n\n                        for box in bboxes:\n                            x, y, x1, y1 = box\n                            x1, y1 = x+x1, y+y1\n                            cv.rectangle(img, (x, y), (x1, y1), (0,255,0), 2)\n        \n                        output_0.add(img)\n                        control_data[0] += 1\n                    \n                sleep(control_data[1])\n                \n        else:\n                \n            output_0 = share_string(output_wires[0])\n        \n            while True:\n    \n                if enabled or (update := bool(enable_wire.get()[0])):\n                    \n                    img = input_0.get()\n                    if img is not None:\n                        bboxes = classifier.detectMultiScale(img)\n                        \n                        to_write = [320, 240, 0, 0]\n                        for box in bboxes:\n                            to_write = [box[0], box[1], box[2], box[3]]\n                            break\n                            \n                        to_write = np.array(to_write, dtype='<U64')\n                        output_0.add(to_write)\n                    \n                    control_data[0] += 1\n                    \n                sleep(control_data[1])\n\n    except KeyboardInterrupt: \n    \n        input_0.release()\n        enable_wire.release()\n        output_0.release()","params":[{"name":"Frequency"},{"name":"BoxOrImage"}],"ports":{"in":[{"name":"Inp"},{"name":"E"}],"out":[{"name":"Out"}]},"size":{"width":"787px","height":"304px"}}},"80874c07-fa76-46f8-a32c-738527dd34ff":{"id":"80874c07-fa76-46f8-a32c-738527dd34ff","type":"basic.input","selected":false,"x":90,"y":284,"ports":[{"id":"40c5414f-029c-45d1-a871-4d931682e961","type":"port.output","x":176,"y":303.1000061035156,"name":"input-out","alignment":"right","parentNode":"80874c07-fa76-46f8-a32c-738527dd34ff","links":["b62cf259-caac-4e28-b915-43357172dc07"],"in":false,"label":"input-out","hideLabel":true}],"data":{"name":"Inp"}},"25770c54-f7e2-44f4-9bda-9cbf42401cdf":{"id":"25770c54-f7e2-44f4-9bda-9cbf42401cdf","type":"basic.input","selected":false,"x":99,"y":424,"ports":[{"id":"9f3ee216-2cbe-462b-a325-df75a5c07210","type":"port.output","x":185,"y":443.1000061035156,"name":"input-out","alignment":"right","parentNode":"25770c54-f7e2-44f4-9bda-9cbf42401cdf","links":["4bdad402-642e-4b25-b0bc-a39d3c138056"],"in":false,"label":"input-out","hideLabel":true}],"data":{"name":"E"}},"421c872f-c3b0-4de0-99dd-1d626d19c9c3":{"id":"421c872f-c3b0-4de0-99dd-1d626d19c9c3","type":"basic.output","selected":false,"x":1207,"y":354,"ports":[{"id":"d9556269-14d7-4002-9ff1-0c47a64f9996","type":"port.input","x":1208,"y":373.1000061035156,"name":"output-in","alignment":"left","parentNode":"421c872f-c3b0-4de0-99dd-1d626d19c9c3","links":["fc2f7bd9-5fbf-4c09-932c-04b5d52b3d5f"],"in":true,"label":"output-in","hideLabel":true}],"data":{"name":"Out"}}}}]},"version":"3.0","package":{"name":"FaceDetector","version":"1.0.0","description":"Detects Faces in an Image.","author":"Muhammad Taha Suhail","image":"data:image/svg+xml;base64,PHN2ZyBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDAgMCAyNCAyNCIgaGVpZ2h0PSI1MTIiIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjUxMiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBpZD0iY29sb3JfMV8iPjxwYXRoIGQ9Im0xMiAxM2MyLjc1NyAwIDUtMi4yNDMgNS01cy0yLjI0My01LTUtNS01IDIuMjQzLTUgNSAyLjI0MyA1IDUgNXoiIGZpbGw9IiM2MDdkOGIiLz48cGF0aCBkPSJtMTYuNSAxNWgtOWMtMi42MTkgMC00Ljc1IDIuMTMxLTQuNzUgNC43NXYzLjVjMCAuNDE0LjMzNi43NS43NS43NWgxN2MuNDE0IDAgLjc1LS4zMzYuNzUtLjc1di0zLjVjMC0yLjYxOS0yLjEzMS00Ljc1LTQuNzUtNC43NXoiIGZpbGw9IiM2MDdkOGIiLz48cGF0aCBkPSJtMTIgM2MtMi43NTcgMC01IDIuMjQzLTUgNXMyLjI0MyA1IDUgNXoiIGZpbGw9IiM1NDZkNzkiLz48cGF0aCBkPSJtMTIgMTVoLTQuNWMtMi42MTkgMC00Ljc1IDIuMTMxLTQuNzUgNC43NXYzLjVjMCAuNDE0LjMzNi43NS43NS43NWg4LjV6IiBmaWxsPSIjNTQ2ZDc5Ii8+PHBhdGggZD0ibTMgNS43NWMtLjU1MiAwLTEtLjQ0Ny0xLTF2LTEuNzVjMC0xLjY1NCAxLjM0Ni0zIDMtM2gxLjVjLjU1MiAwIDEgLjQ0NyAxIDFzLS40NDggMS0xIDFoLTEuNWMtLjU1MSAwLTEgLjQ0OC0xIDF2MS43NWMwIC41NTMtLjQ0OCAxLTEgMXoiIGZpbGw9IiMwMGJjZDQiLz48cGF0aCBkPSJtNi41IDE0aC0xLjVjLTEuNjU0IDAtMy0xLjM0Ni0zLTN2LTEuNzVjMC0uNTUzLjQ0OC0xIDEtMXMxIC40NDcgMSAxdjEuNzVjMCAuNTUyLjQ0OSAxIDEgMWgxLjVjLjU1MiAwIDEgLjQ0NyAxIDFzLS40NDggMS0xIDF6IiBmaWxsPSIjMDBiY2Q0Ii8+PHBhdGggZD0ibTQuNzUuMDFjLTEuNTM4LjEyOC0yLjc1IDEuNDItMi43NSAyLjk5djEuNzVjMCAuNTUzLjQ0OCAxIDEgMXMxLS40NDcgMS0xdi0xLjc1YzAtLjQ2NS4zMTktLjg1Ny43NS0uOTY4eiIgZmlsbD0iIzAwYTRiOSIvPjxwYXRoIGQ9Im0zIDguMjVjLS41NTIgMC0xIC40NDctMSAxdjEuNzVjMCAxLjU3IDEuMjEyIDIuODYyIDIuNzUgMi45OXYtMi4wMjFjLS40MzEtLjExMi0uNzUtLjUwNC0uNzUtLjk2OXYtMS43NWMwLS41NTMtLjQ0OC0xLTEtMXoiIGZpbGw9IiMwMGE0YjkiLz48cGF0aCBkPSJtMjEgNS43NWMtLjU1MiAwLTEtLjQ0Ny0xLTF2LTEuNzVjMC0uNTUyLS40NDktMS0xLTFoLTEuNWMtLjU1MiAwLTEtLjQ0Ny0xLTFzLjQ0OC0xIDEtMWgxLjVjMS42NTQgMCAzIDEuMzQ2IDMgM3YxLjc1YzAgLjU1My0uNDQ4IDEtMSAxeiIgZmlsbD0iIzAwYmNkNCIvPjxwYXRoIGQ9Im0xOSAxNGgtMS41Yy0uNTUyIDAtMS0uNDQ3LTEtMXMuNDQ4LTEgMS0xaDEuNWMuNTUxIDAgMS0uNDQ4IDEtMXYtMS43NWMwLS41NTMuNDQ4LTEgMS0xczEgLjQ0NyAxIDF2MS43NWMwIDEuNjU0LTEuMzQ2IDMtMyAzeiIgZmlsbD0iIzAwYmNkNCIvPjxnIGZpbGw9IiMwMGE0YjkiPjxwYXRoIGQ9Im0xOSAwaC0xLjVjLS41NTIgMC0xIC40NDctMSAxcy40NDggMSAxIDFoMS41Yy4wODYgMCAuMTcuMDExLjI1LjAzMnYtMi4wMjJjLS4wODItLjAwNy0uMTY2LS4wMS0uMjUtLjAxeiIvPjxwYXRoIGQ9Im0xOS4yNSAxMS45NjhjLS4wOC4wMjEtLjE2NC4wMzItLjI1LjAzMmgtMS41Yy0uNTUyIDAtMSAuNDQ3LTEgMXMuNDQ4IDEgMSAxaDEuNWMuMDg0IDAgLjE2OC0uMDAzLjI1LS4wMXoiLz48L2c+PC9nPjwvc3ZnPg=="},"design":{"board":"Python3-Noetic","graph":{"blocks":[{"id":"0001-63745519-5dec-4f70-9e52-dbeacf4d8dea","type":"basic.constant","data":{"name":"Frequency","value":"30.0","local":true},"position":{"x":543,"y":13}},{"id":"0002-eff9b053-aae5-4081-a9bf-3dad18a381e8","type":"basic.constant","data":{"name":"box/image","value":"image","local":true},"position":{"x":699,"y":13}},{"id":"a0403155-b994-46ed-b65e-80646aece826","type":"basic.code","data":{"code":"import cv2 as cv\nimport numpy as np\nfrom time import sleep\nfrom utils.wires.wire_img import read_image, share_image\nfrom utils.wires.wire_str import read_string, share_string\nfrom utils.tools.freq_monitor import monitor_frequency\n\ndef loop(block_name, input_wires, output_wires, parameters, flags):\n\n    input_0 = read_image(input_wires[0])\n    output_0 = share_image(output_wires[0])\n    choice = parameters[1]\n\n    enabled = False\n    try:\n        enable_wire = read_string(input_wires[1])\n    except IndexError:\n        enabled = True\n    \n    required_frequency, update = float(parameters[0]), 1\n    control_data = np.array([0.0,0.03])\n    \n    if flags[0] == 1:\n        monitor_frequency(block_name, control_data, required_frequency, update)\n\n    classifier = cv.CascadeClassifier('utils/models/haar_cascade/haarcascade_frontalface_default.xml')\n\n    try:\n    \n        if choice == 'image':\n\n            output_0 = share_image(output_wires[0])\n        \n            while True:\n        \n                if enabled or (update := bool(enable_wire.get()[0])):\n    \n                    img = input_0.get()\n                    if img is not None:\n                        bboxes = classifier.detectMultiScale(img)\n\n                        for box in bboxes:\n                            x, y, x1, y1 = box\n                            x1, y1 = x+x1, y+y1\n                            cv.rectangle(img, (x, y), (x1, y1), (0,255,0), 2)\n        \n                        output_0.add(img)\n                        control_data[0] += 1\n                    \n                sleep(control_data[1])\n                \n        else:\n                \n            output_0 = share_string(output_wires[0])\n        \n            while True:\n    \n                if enabled or (update := bool(enable_wire.get()[0])):\n                    \n                    img = input_0.get()\n                    if img is not None:\n                        bboxes = classifier.detectMultiScale(img)\n                        \n                        to_write = [320, 240, 0, 0]\n                        for box in bboxes:\n                            to_write = [box[0], box[1], box[2], box[3]]\n                            break\n                            \n                        to_write = np.array(to_write, dtype='<U64')\n                        output_0.add(to_write)\n                    \n                    control_data[0] += 1\n                    \n                sleep(control_data[1])\n\n    except KeyboardInterrupt: \n    \n        input_0.release()\n        enable_wire.release()\n        output_0.release()","params":[{"name":"Frequency"},{"name":"BoxOrImage"}],"ports":{"in":[{"name":"Inp"},{"name":"E"}],"out":[{"name":"Out"}]},"size":{"width":"787px","height":"304px"}},"position":{"x":259,"y":201}},{"id":"80874c07-fa76-46f8-a32c-738527dd34ff","type":"basic.input","data":{"name":"Inp"},"position":{"x":90,"y":284}},{"id":"25770c54-f7e2-44f4-9bda-9cbf42401cdf","type":"basic.input","data":{"name":"E"},"position":{"x":99,"y":424}},{"id":"421c872f-c3b0-4de0-99dd-1d626d19c9c3","type":"basic.output","data":{"name":"Out"},"position":{"x":1207,"y":354}}],"wires":[{"source":{"block":"0001-63745519-5dec-4f70-9e52-dbeacf4d8dea","port":"constant-out"},"target":{"block":"a0403155-b994-46ed-b65e-80646aece826","port":"Frequency"}},{"source":{"block":"0002-eff9b053-aae5-4081-a9bf-3dad18a381e8","port":"constant-out"},"target":{"block":"a0403155-b994-46ed-b65e-80646aece826","port":"BoxOrImage"}},{"source":{"block":"80874c07-fa76-46f8-a32c-738527dd34ff","port":"input-out"},"target":{"block":"a0403155-b994-46ed-b65e-80646aece826","port":"Inp"}},{"source":{"block":"25770c54-f7e2-44f4-9bda-9cbf42401cdf","port":"input-out"},"target":{"block":"a0403155-b994-46ed-b65e-80646aece826","port":"E"}},{"source":{"block":"a0403155-b994-46ed-b65e-80646aece826","port":"Out"},"target":{"block":"421c872f-c3b0-4de0-99dd-1d626d19c9c3","port":"output-in"}}]}},"dependencies":{}}